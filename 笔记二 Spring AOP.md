# 笔记二 Spring AOP

[TOC]

## 1. AOP

### 1.1 什么是AOP？

> 面向切面编程

主要包含：

> - 切入点：执行目标对象
>
> - 切面：抽出重复代码的类，用于运行时再业务代码上的类。
> - 关注点：重复代码



### 1.2 为什么要使用AOP？ 

- 解决代码的复用问题

- 解耦

  

### 1.3 AOP 做什么？

- 日志安全
- 权限
- 事务
- 性能监控



### 1.4 AOP 有几种通知方式？

- 1. 环绕通知

  > 在方法前后处理事情。

- 2. 前置通知

  > 在方法之前进行处理事情。

- 3. 后置通知

  > 在执行完方法后，进行处理事件。

- 4. 异常通知

  > 在方法抛出异常后，进行处理事件。

- 5. 最终通知

  > 是在目标方法执行之后执行的通知。

  *注意：最终通知无论如何都会在目标方法调用过后执行，即使目标方法没有正常的执行完成。*



## 2. Spring 事务

### 2.1事务有什么特性？

- 原子性
- 一致性
- 持久化
- 隔离性



### 2.2 事务是怎么实现的？

> 事务是基于SpringAOP 的环绕通知和异常通知实现的。



### 2.3 事务有多少种？

- 编程事务

  > 就像我们使用的SVN,GIT 一样是手动实现commit...等。

- 声明事务

  > 手写SVN.Git + AOP 技术。

  

### 2.4 事务有多少种传播行为？

- 1. required

  > 当前没有事务，就会新建一个事务。 

- 2. newRequired

  > 当前有事务，就把当前事务挂起。

- 3. support

  > 当前没有事务，就以非事务执行方式。

- 4. noSupport

  > 当前有事务，就把当前事务挂起。

- 5. mandatory

  > 当前没有事务，就抛出异常。

- 6. never

  > 当前有事务，就会抛出异常。（非事务执行方式）





## 3. AOP 底层实现原理

> Aop 底层实现，是通过使用代理设计模式。

- 动态代理
- 静态代理



### 3.1 什么是静态代理？

>  需要产生目标对象。（每次创建一个代理，都需要创建一个代理类）。



### 3.2 什么是动态代理？

> 不需要产生目标对象。

- jdk 动态代理

  > 1. jdk 需要接口，动态代理只需要子类实现。
  > 2. 基于反射实现的（虚拟生成的）。

  

- CGLIB 动态代理

  > 1. 是基于ASM 字节码包装的一个类库。
  >
  > 2. 生成字节码后放入到jvm中进行运行。



## 4. 怎样使用AOP注解

使用 @Compoment @Aspect 在类上标注。













